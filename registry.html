<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Registry | Gabriel & Michelle</title>
  <link rel="stylesheet" href="site.css" />
  <script src="i18n.js"></script>
</head>
<body onload="initWeddingSite(); renderRegistry();">

  <div class="navbar">
    <div class="nav-inner">
      <div class="brand">G &amp; M</div>
      <div class="nav-links">
        <a href="index.html" data-i18n="nav_home"></a>
        <a href="our-story.html" data-i18n="nav_story"></a>
        <a href="dress-code.html" data-i18n="nav_dress"></a>
        <a href="qa.html" data-i18n="nav_qa"></a>
        <a href="travel.html" data-i18n="nav_travel"></a>
        <a href="registry.html" data-i18n="nav_registry"></a>
        <a href="rsvp.html" data-i18n="nav_rsvp"></a>
      </div>
      <div class="lang-toggle">
        <button id="langEN" class="pill" onclick="setLang('en'); renderRegistry();">EN</button>
        <button id="langES" class="pill" onclick="setLang('es'); renderRegistry();">ES</button>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="card">
      <h1 class="page-title" data-i18n="registry_title"></h1>
      <p class="muted" data-i18n="registry_sub"></p>

      <div class="hr"></div>

      <div id="registryList" class="list"></div>

      <div class="hr"></div>
      <p class="tiny muted" data-i18n="registry_note"></p>
    </div>
  </div>

  <script>
    const items = [
      // Replace with your real registry items
      { id:"item1", nameEN:"Knife set", nameES:"Juego de cuchillos", link:"https://example.com" },
      { id:"item2", nameEN:"Air fryer", nameES:"Freidora de aire", link:"https://example.com" },
      { id:"item3", nameEN:"Bedding set", nameES:"Juego de sÃ¡banas", link:"https://example.com" }
    ];

    function getPurchasedMap(){
      try { return JSON.parse(localStorage.getItem("registry_purchased") || "{}"); }
      catch(e){ return {}; }
    }
    function setPurchased(id, val){
      const map = getPurchasedMap();
      map[id] = val;
      localStorage.setItem("registry_purchased", JSON.stringify(map));
      renderRegistry();
    }

    function renderRegistry(){
      const lang = (localStorage.getItem("wedding_lang") === "es") ? "es" : "en";
      const purchased = getPurchasedMap();
      const wrap = document.getElementById("registryList");
      wrap.innerHTML = "";

      items.forEach(it=>{
        const isBought = !!purchased[it.id];
        const name = (lang === "es") ? it.nameES : it.nameEN;

        const card = document.createElement("div");
        card.className = "card";
        card.style.boxShadow = "none";
        card.style.border = "1px solid rgba(0,0,0,.08)";

        const row = document.createElement("div");
        row.className = "row";

        const left = document.createElement("div");
        const title = document.createElement("strong");
        title.textContent = name;
        if (isBought) title.classList.add("strike");

        const sub = document.createElement("div");
        sub.className = "tiny muted";
        sub.textContent = isBought
          ? (lang === "es" ? "Comprado" : "Purchased")
          : (lang === "es" ? "Disponible" : "Available");

        left.appendChild(title);
        left.appendChild(sub);

        const right = document.createElement("div");
        right.style.display = "flex";
        right.style.gap = "10px";
        right.style.flexWrap = "wrap";

        const view = document.createElement("a");
        view.className = "btn btn-outline";
        view.href = it.link;
        view.target = "_blank";
        view.rel = "noopener";
        view.textContent = (lang === "es" ? "Ver" : "View");

        const toggle = document.createElement("button");
        toggle.className = "btn";
        toggle.textContent = isBought
          ? (lang === "es" ? "Marcar como disponible" : "Mark available")
          : (lang === "es" ? "Marcar como comprado" : "Mark purchased");
        toggle.onclick = ()=> setPurchased(it.id, !isBought);

        right.appendChild(view);
        right.appendChild(toggle);

        row.appendChild(left);
        row.appendChild(right);

        card.appendChild(row);
        wrap.appendChild(card);
      });
    }
  </script>

</body>
</html>
